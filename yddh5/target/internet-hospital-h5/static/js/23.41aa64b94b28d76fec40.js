webpackJsonp([23],{MTrT:function(t,s){},gBkI:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var o=e("3cXf"),i=e.n(o),n=e("mMon"),a=e("eoeZ"),c=e("uVW5"),r=e("9rMa"),l={data:function(){return{load_show:!1,notice_show:"",couponAvailableList:[],couponNotAvailableList:[],useThisCoupon:null}},components:{NoticeDialog:n.a,Notice:a.a,Loading:c.a},computed:Object(r.b)({header:function(t){return""===t.header&&this.$store.commit("setUser",JSON.parse(localStorage.getItem("loginInfo"))),t.header},userId:function(t){return""===t.userId&&this.$store.commit("setUser",JSON.parse(localStorage.getItem("loginInfo"))),t.userId}}),activated:function(){var t=this.$route.query;console.log(t),this.getInfo(t)},methods:{getInfo:function(t){this.getFirstInfo(t);var s=localStorage.getItem("useThisCoupon");s&&(console.log(s),this.useThisCoupon=s)},getFirstInfo:function(t){var s=this,e=this.$conf.url+"/internethospital/api/inventories/coupons?user-id="+this.userId+"&page-index=1&page-size=10000";this.$axios.post(e,{},{headers:this.$store.state.header}).then(function(e){console.log(e);var o=e.data.content;for(var i in o)o[i].amount=o[i].amount.toString().replace("-",""),o[i].startTime=o[i].startTime.slice(0,o[i].startTime.indexOf(" ")),o[i].startTime=o[i].startTime.replace(/-/g,"."),o[i].endTime=o[i].endTime.slice(0,o[i].endTime.indexOf(" ")),o[i].endTime=o[i].endTime.replace(/-/g,"."),o[i].showUseNotice=!1;var n=o.filter(function(s){return"AVAILABLE"===s.status&&(s.departmentId?s.departmentId===t.departmentId:!s.organizationId||s.organizationId===t.organizationId)}),a=o.filter(function(s){return"CREATED"===s.status||"AVAILABLE"===s.status&&(s.organizationId?s.organizationId!==t.organizationId:!!s.departmentId&&s.departmentId!==t.departmentId)});console.log(n),console.log(a),s.couponAvailableList=n,s.couponNotAvailableList=a}).catch(function(t){s.notice_show=t.response.data.message,setTimeout(function(){s.notice_show=""},1500)})},showOrHideUseNotice:function(t){console.log(t);var s=t,e=this.couponAvailableList,o=this.couponNotAvailableList;for(var i in e)e[i].id===s&&(e[i].showUseNotice=!e[i].showUseNotice);for(var n in o)o[n].id===s&&(o[n].showUseNotice=!o[n].showUseNotice);this.couponAvailableList=e,this.couponNotAvailableList=o},choseThis:function(t){console.log(t);var s=this.couponAvailableList.find(function(s){return s.id===t});console.log(s),this.useThisCoupon=s,localStorage.setItem("useThisCoupon",i()(s)),this.$router.back()}}},u={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"page"},[e("div",{staticClass:"section"},[t._l(t.couponAvailableList,function(s,o){return t.couponAvailableList.length>0?e("div",{staticClass:"coupon-item",on:{click:function(e){t.choseThis(s.id)}}},[e("img",{attrs:{src:"static/images/coupon-for-all.png"}}),t._v(" "),e("div",{staticClass:"basic-info"},[e("div",{staticClass:"left"},[t._v("￥"),e("span",[t._v(t._s(s.amount))])]),t._v(" "),e("div",{staticClass:"left"},[e("span",[t._v(t._s(s.text))]),t._v(" "),e("span",[t._v(t._s(s.startTime)+"-"+t._s(s.endTime))])]),t._v(" "),e("div",{staticClass:"right"},[t.useThisCoupon&&t.useThisCoupon.id===s.id?e("img",{attrs:{src:"/static/images/chosen.png"}}):e("span")]),t._v(" "),s.longText?e("button",{staticClass:"show-use-notice",on:{click:function(e){t.showOrHideUseNotice(s.id)}}},[t._v("使用须知"),s.showUseNotice?e("img",{staticClass:"right",attrs:{src:"static/images/coupon-notice-close.png"}}):e("img",{staticClass:"right",attrs:{src:"static/images/coupon-notice-open.png"}})]):t._e()]),t._v(" "),s.showUseNotice?e("div",{staticClass:"use-notice"},[t._v(t._s(s.longText))]):t._e()]):t._e()}),t._v(" "),t.couponNotAvailableList.length>0?e("div",{staticClass:"part-line"},[e("span"),t._v(" "),e("span",[t._v("以下优惠券不适用")]),t._v(" "),e("span")]):t._e(),t._v(" "),t._l(t.couponNotAvailableList,function(s,o){return t.couponNotAvailableList.length>0?e("div",{staticClass:"coupon-item"},[e("img",{attrs:{src:"/static/images/coupon-used.png"}}),t._v(" "),e("div",{staticClass:"basic-info"},[e("div",{staticClass:"left"},[t._v("￥"),e("span",[t._v(t._s(s.amount))])]),t._v(" "),e("div",{staticClass:"left"},[e("span",[t._v(t._s(s.text))]),t._v(" "),e("span",[t._v(t._s(s.startTime)+"-"+t._s(s.endTime))])]),t._v(" "),s.longText?e("button",{staticClass:"show-use-notice",on:{click:function(e){t.showOrHideUseNotice(s.id)}}},[t._v("使用须知"),s.showUseNotice?e("img",{staticClass:"right",attrs:{src:"static/images/coupon-notice-close.png"}}):e("img",{staticClass:"right",attrs:{src:"static/images/coupon-notice-open.png"}})]):t._e()]),t._v(" "),s.showUseNotice?e("div",{staticClass:"use-notice"},[t._v(t._s(s.longText))]):t._e()]):t._e()})],2),t._v(" "),e("notice",{directives:[{name:"show",rawName:"v-show",value:t.notice_show,expression:"notice_show"}],attrs:{message:t.notice_show}}),t._v(" "),e("loading",{directives:[{name:"show",rawName:"v-show",value:t.load_show,expression:"load_show"}]})],1)},staticRenderFns:[]};var d=e("C7Lr")(l,u,!1,function(t){e("MTrT")},"data-v-4427ecf1",null);s.default=d.exports}});
//# sourceMappingURL=23.41aa64b94b28d76fec40.js.map