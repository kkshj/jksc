webpackJsonp([19],{QDS5:function(t,e){},"spz/":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("mMon"),n=a("eoeZ"),o=a("uVW5"),i=a("9rMa"),r={name:"consultation",components:{NoticeDialog:s.a,Notice:n.a,Loading:o.a},data:function(){return{conversationList:[],notice:"",totalPages:0,currentPage:1,getting:!1}},computed:Object(i.b)({userId:function(t){return""===t.userId&&this.$store.commit("setUser",JSON.parse(localStorage.getItem("loginInfo"))),t.userId},header:function(t){return""===t.header&&this.$store.commit("setUser",JSON.parse(localStorage.getItem("loginInfo"))),t.header}}),activated:function(){this.$store.commit("changePageType","main-page"),this.getInfo()},methods:{getInfo:function(){this.conversationList=[],this.getting=!0,this.getConsultations(1)},getMore:function(t){var e=this;if(!this.getting){var a=t.target||t.srcElement,s=this.$refs.listBox.offsetHeight,n=a.scrollTop+document.documentElement.offsetHeight;this.totalPages>0&&n>=s-200?(this.getting=!0,this.getConsultations(this.currentPage+1)):0===this.totalPages&&(this.notice="没有更多了",this.getting=!0,setTimeout(function(){e.notice=""},2e3))}},getConsultations:function(t){var e=this,a=this.$conf.url+"/internethospital/api/orders/consultations?user-id="+this.userId+"&status=PAYED&status=RECEIVED&status=DOCTOR_COMPLETED&status=AUTO_COMPLETED&page-index="+t+"&page-size=10";this.$axios.get(a,{headers:this.header}).then(function(a){for(var s in 1===t?e.totalPages=a.data.totalPages:e.totalPages-=1,a.data.content)a.data.content[s].doctorAvatar&&a.data.content[s].doctorAvatar.indexOf("qnfiles")>0&&(a.data.content[s].doctorAvatar=a.data.content[s].doctorAvatar+"-doctor_list"),a.data.content[s].nurseAvatar&&a.data.content[s].nurseAvatar.indexOf("qnfiles")>0&&(a.data.content[s].nurseAvatar=a.data.content[s].nurseAvatar+"-doctor_list"),a.data.content[s].createdDate=a.data.content[s].createdDate.slice(0,a.data.content[s].createdDate.lastIndexOf(":"));e.conversationList=e.conversationList.concat(a.data.content),e.currentPage=t,e.getting=!1}).catch(function(t){e.notice=t.response.data.message,setTimeout(function(){e.notice=""},2e3)})},jumpTo:function(t,e){this.$store.commit("changePageType","package-page"),this.$router.push("/"+t+"/"+e)}}},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page",on:{scroll:t.getMore}},[0===t.conversationList.length?a("div",{staticClass:"emp"},[a("img",{attrs:{src:"static/images/empty-message.png"}}),t._v(" "),a("span",[t._v("你还没有咨询消息")])]):t._e(),t._v(" "),t.conversationList.length>0?a("ul",{ref:"listBox",staticClass:"contain"},t._l(t.conversationList,function(e){return a("li",{on:{click:function(a){t.jumpTo("chat",e.orderHeaderId)}}},[a("img",{staticClass:"left",attrs:{src:e.doctorAvatar||e.nurseAvatar||"static/images/defualt-header.png"}}),t._v(" "),a("div",{staticClass:"left"},[a("div",{staticClass:"doctor"},[a("span",{staticClass:"left"},[t._v(t._s(e.doctorName||e.nurseName))]),a("span",{staticClass:"left"},[t._v(t._s(e.departmentText))]),a("span",{staticClass:"right"},[t._v(t._s(e.createdDate))])]),t._v(" "),a("div",{staticClass:"patient"},[a("span",{staticClass:"left"},[t._v("就诊人 / "+t._s(e.patientName))]),e.newMessage?a("span",{staticClass:"tag right"}):t._e()]),t._v(" "),"DOCTOR_COMPLETED"===e.statusCode||"AUTO_COMPLETED"===e.statusCode?a("img",{attrs:{src:"static/images/end.png"}}):t._e()])])})):t._e(),t._v(" "),t.notice?a("notice",{attrs:{message:t.notice}}):t._e()],1)},staticRenderFns:[]};var d=a("C7Lr")(r,c,!1,function(t){a("QDS5")},"data-v-5de267fa",null);e.default=d.exports}});
//# sourceMappingURL=19.b2a234895f16650b060c.js.map