webpackJsonp([13],{SUe3:function(t,e){},p6tq:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("HzJ8"),o=s.n(i),r=s("3cXf"),a=s.n(r),n=s("mMon"),c=s("eoeZ"),l=s("uVW5"),h=s("9rMa"),v={data:function(){return{message:"",load_show:!1,notice_show:"",beforeSearch:!0,price:"",historyList:[],docList:[],totalPages:0,currentPage:1,getting:!1}},components:{NoticeDialog:n.a,Notice:c.a,Loading:l.a},computed:Object(h.b)({hospitalPorts:function(t){return""===t.hospitalPort&&this.$store.commit("setHospital",JSON.parse(localStorage.getItem("hospitalInfo"))),t.hospitalPort},hospitalId:function(t){return""===t.hospitalId&&this.$store.commit("setHospital",JSON.parse(localStorage.getItem("hospitalInfo"))),t.hospitalId}}),activated:function(){this.$store.commit("changePageType","package-page");var t=this.$route.query;console.log(t),this.getInfo()},methods:{getInfo:function(){this.price="",this.docList=[],this.getHistory()},getMore:function(t){var e=this;if(!this.getting){var s=t.target||t.srcElement,i=this.$refs.listBox.offsetHeight,o=s.scrollTop+document.documentElement.offsetHeight;this.totalPages>0&&o>=i-200?(this.getting=!0,this.search(this.price,this.currentPage+1)):0===this.totalPages&&(this.getting=!0,this.notice_show="没有更多了",setTimeout(function(){e.notice_show=""},2e3))}},search:function(t,e){var s=this;1==e&&(this.docList=[]),this.price=t,this.$refs.search.blur(),this.load_show=!0;var i=this,r=[],n=t;if(!/^[A-Za-z0-9\u4e00-\u9fa5]+$/g.test(n))return this.notice_show="请输入医生姓名（汉字/英文/数字）",void setTimeout(function(){s.notice_show=""},1500);(r=r.concat(this.historyList)).find(function(t){return t.name===n})||r.unshift({name:n}),r.length>10&&r.pop(),this.historyList=r,n=encodeURI(n),localStorage.setItem("searchHistory",a()(r)),console.log(JSON.parse(localStorage.getItem("searchHistory")));var c=i.$conf.url+"/internethospital/api/doctors?page-index="+e+"&page-size=10&name="+n;i.hospitalPort&&(c=c+"&organization-id="+i.hospitalId),console.log("url::",c),console.log("value::",n),i.$axios.get(c,{"content-type":"application/json"}).then(function(t){1===e?s.totalPages=t.data.totalPages:(s.totalPages-=1,console.log(s.totalPages)),console.log(t);var r=t.data.content;for(var a in r=r.filter(function(t){return t.services.length>0})){var n=r[a].services.indexOf(r[a].services.find(function(t){return"CONSULT"===t.code}));n>0&&(r[a].services[0]=[r[a].services[n],r[a].services[n]=r[a].services[0]][0]),r[a].doctorAvatar?r[a].doctorAvatar=r[a].doctorAvatar+"-doctor_list":r[a].doctorAvatar="/static/images/defualt-header.png",r[a].services.find(function(t){return"CONSULT_FREE"===t.code})&&(r[a].services.find(function(t){return"CONSULT_FREE"===t.code}).inventoryQuantity||r[a].services.find(function(t){return"CONSULT_FREE"===t.code}).inventoryQuantity>0)&&(r[a].volunteers=r[a].services.find(function(t){return"CONSULT_FREE"===t.code}).inventoryQuantity),r[a].services[0]&&r[a].services[0].price.toString().indexOf(".")<0?r[a].services[0].price=r[a].services[0].price+".00":r[a].services[0]&&2!==r[a].services[0].price.toString().slice(r[a].services[0].price.toString().indexOf(".")+1).length&&(r[a].services[0].price=r[a].services[0].price+"0"),r[a].text=r[a].text.length<35?r[a].text:r[a].text.slice(0,36)+"...";var c=r[a].statistics.filter(function(t){return"ORDER"===t.type}),l=0,h=!0,v=!1,u=void 0;try{for(var d,g=o()(c);!(h=(d=g.next()).done);h=!0){l+=d.value.quantity}}catch(t){v=!0,u=t}finally{try{!h&&g.return&&g.return()}finally{if(v)throw u}}r[a].customerCount=l}i.docList=s.docList.concat(r),i.beforeSearch=!1,s.currentPage=e,s.load_show=!1,s.getting=!1})},cancel:function(){console.log("back to index"),this.$router.back()},getHistory:function(){console.log("OK");this.historyList=[];var t=JSON.parse(localStorage.getItem("searchHistory"));t&&(this.beforeSearch=!0,this.historyList=t,console.log(this.historyList))},cleanHistory:function(){var t=this;localStorage.removeItem("searchHistory"),this.notice_show="清除成功",setTimeout(function(){t.notice_show="",t.$router.go(0)},1500)},jumpTo:function(t){console.log(t),this.$store.commit("changePageType","package-page");var e=void 0;e=t.doctorId?"/doctor/"+t.doctorId:"/nurse/"+t.doctorId,this.$router.push(e)}}},u={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"page",on:{scroll:t.getMore}},[s("div",{staticClass:"search-bar"},[s("div",{staticClass:"left"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.price,expression:"price"}],ref:"search",attrs:{placeholder:"搜索医生",maxlength:"6",type:"search"},domProps:{value:t.price},on:{keyup:function(e){if(!("button"in e)&&13!==e.keyCode)return null;t.search(t.price,1)},input:function(e){e.target.composing||(t.price=e.target.value)}}})]),t._v(" "),s("span",{staticClass:"right",on:{click:t.cancel}},[t._v("取消")])]),t._v(" "),s("div",{staticClass:"section"},[t.beforeSearch?s("div",{staticClass:"history"},[t.historyList.length>0?s("div",{staticClass:"title"},[s("span",{staticClass:"left"},[t._v("搜索历史")]),t._v(" "),s("img",{staticClass:"right",attrs:{src:"static/images/clean.png"},on:{click:t.cleanHistory}})]):t._e(),t._v(" "),s("div",{staticClass:"content"},t._l(t.historyList,function(e,i){return s("i",{staticClass:"left",on:{click:function(s){t.search(e.name,1)}}},[t._v(t._s(e.name))])}))]):t._e(),t._v(" "),t.beforeSearch||0!==t.docList.length?t._e():s("div",{staticClass:"emp"},[s("img",{attrs:{src:"static/images/empty-search.png"}}),t._v(" "),s("span",[t._v("没有相关信息")])]),t._v(" "),t.beforeSearch?t._e():s("div",{ref:"listBox",staticClass:"doctor"},t._l(t.docList,function(e,i){return s("li",{on:{click:function(s){t.jumpTo(e)}}},[s("img",{staticClass:"left",attrs:{src:e.doctorAvatar}}),t._v(" "),s("div",{staticClass:"left"},[s("div",[s("span",{staticClass:"left"},[t._v(t._s(e.doctorName))]),t._v(" "),s("span",{staticClass:"left"},[t._v(t._s(e.positionalTitleText))]),t._v(" "),s("div",{staticClass:"left"},t._l(e.labels,function(e,i){return i<2?s("i",{style:e.colour?"background-color:"+e.colour:"color: #333333"},[t._v(t._s(e.text))]):t._e()})),t._v(" "),e.volunteers>0?s("span",{staticClass:"right"},[t._v(t._s(e.volunteers))]):t._e()]),t._v(" "),s("div",[s("span",[t._v(t._s(e.organizationText))]),s("span",[t._v(t._s(e.departmentText))])]),t._v(" "),s("div",[s("span",[t._v(t._s(e.text))])]),t._v(" "),s("div",[s("span",{staticClass:"left"},[t._v("￥"+t._s(e.services[0].price)+"/次")]),s("span",{staticClass:"right"},[t._v(t._s(e.customerCount)+"人已问诊")])])])])})),t._v(" "),s("notice",{directives:[{name:"show",rawName:"v-show",value:t.notice_show,expression:"notice_show"}],attrs:{message:t.notice_show}}),t._v(" "),s("loading",{directives:[{name:"show",rawName:"v-show",value:t.load_show,expression:"load_show"}]})],1)])},staticRenderFns:[]};var d=s("C7Lr")(v,u,!1,function(t){s("SUe3")},"data-v-771b7a10",null);e.default=d.exports}});
//# sourceMappingURL=13.cd2250716b6c1a8e1d99.js.map