{"version":3,"sources":["webpack:///src/components/consultation.component.vue","webpack:///./src/components/consultation.component.vue?52fe","webpack:///./src/components/consultation.component.vue"],"names":["consultation_component","name","components","NoticeDialog","notice_dialog_component","Notice","notice_component","Loading","loading_component","data","conversationList","notice","totalPages","currentPage","getting","computed","Object","vuex_esm","userId","state","this","$store","commit","JSON","parse","localStorage","getItem","header","activated","getInfo","methods","getConsultations","getMore","e","_this","target","srcElement","listHeight","$refs","offsetHeight","bottom","scrollTop","document","documentElement","setTimeout","page","_this2","url","$conf","$axios","get","headers","then","res","i","content","doctorAvatar","indexOf","nurseAvatar","createdDate","slice","lastIndexOf","concat","catch","err","response","message","jumpTo","route","id","$router","push","components_consultation_component","render","_vm","_h","$createElement","_c","_self","staticClass","on","scroll","length","attrs","src","_v","_e","ref","_l","item","click","$event","orderHeaderId","_s","doctorName","nurseName","departmentText","patientName","statusCode","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/19.b2a234895f16650b060c.js","sourcesContent":["<template>\r\n    <div class=\"page\" @scroll=\"getMore\">\r\n      <div class='emp' v-if='conversationList.length === 0'>\r\n        <img src='static/images/empty-message.png'>\r\n        <span>你还没有咨询消息</span>\r\n      </div>\r\n      <ul ref=\"listBox\" class='contain' v-if='conversationList.length > 0' >\r\n        <li v-for='item in conversationList' @click=\"jumpTo('chat', item.orderHeaderId)\">\r\n          <img class='left' :src='item.doctorAvatar || item.nurseAvatar || \"static/images/defualt-header.png\"'>\r\n          <div class='left'>\r\n            <div class='doctor'><span class='left'>{{item.doctorName || item.nurseName}}</span><span class='left'>{{item.departmentText}}</span><span class='right'>{{item.createdDate}}</span></div>\r\n            <div class='patient'><span class='left'>就诊人 / {{item.patientName}}</span><span v-if='item.newMessage' class='tag right'></span></div>\r\n            <img v-if='item.statusCode === \"DOCTOR_COMPLETED\" || item.statusCode === \"AUTO_COMPLETED\"' src='static/images/end.png'>\r\n          </div>\r\n        </li>\r\n      </ul>\r\n      <notice v-if=\"notice\" :message=\"notice\"></notice>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n  import NoticeDialog from './notice-dialog.component'\r\n  import Notice from './notice.component'\r\n  import Loading from './loading.component'\r\n  import { mapState } from 'vuex'\r\n\r\n  export default {\r\n    name: \"consultation\",\r\n    components: {\r\n      NoticeDialog,\r\n      Notice,\r\n      Loading\r\n    },\r\n    data () {\r\n        return {\r\n          conversationList: [],\r\n          notice: '',\r\n          totalPages: 0,\r\n          currentPage: 1,\r\n          getting: false\r\n        }\r\n    },\r\n    computed: mapState({\r\n      userId (state) {\r\n        if (state.userId === '') {\r\n          this.$store.commit('setUser', JSON.parse(localStorage.getItem('loginInfo')));\r\n        }\r\n        return state.userId\r\n      },\r\n      header (state) {\r\n        if (state.header === '') {\r\n          this.$store.commit('setUser', JSON.parse(localStorage.getItem('loginInfo')));\r\n        }\r\n        return state.header\r\n      }\r\n    }),\r\n    activated () {\r\n      this.$store.commit('changePageType', 'main-page');\r\n      this.getInfo();\r\n    },\r\n    methods: {\r\n      getInfo () {\r\n        this.conversationList = [];\r\n        this.getting = true;\r\n        this.getConsultations(1);\r\n      },\r\n      getMore (e) {\r\n        if (!this.getting) {\r\n          let target = e.target || e.srcElement;\r\n          let listHeight = this.$refs['listBox'].offsetHeight;\r\n          let bottom = target.scrollTop + document.documentElement.offsetHeight;\r\n          if (this.totalPages > 0 && (bottom >= listHeight - 200)) {\r\n            this.getting = true;\r\n            this.getConsultations(this.currentPage + 1)\r\n          } else {\r\n            if (this.totalPages === 0) {\r\n              this.notice = '没有更多了';\r\n              this.getting = true;\r\n              setTimeout(()=>{\r\n                this.notice = ''\r\n              }, 2000)\r\n            }\r\n          }\r\n        }\r\n      },\r\n      getConsultations (page) {\r\n        const url = `${this.$conf.url}/internethospital/api/orders/consultations?user-id=${this.userId}&status=PAYED&status=RECEIVED&status=DOCTOR_COMPLETED&status=AUTO_COMPLETED&page-index=${page}&page-size=10`;\r\n        this.$axios.get(url, {headers: this.header}).then(res => {\r\n          if (page === 1) {\r\n            this.totalPages = res.data.totalPages;\r\n          } else {\r\n            this.totalPages -= 1;\r\n          }\r\n          for (let i in res.data.content) {\r\n            if (res.data.content[i].doctorAvatar && res.data.content[i].doctorAvatar.indexOf('qnfiles') > 0) {\r\n              res.data.content[i].doctorAvatar = `${res.data.content[i].doctorAvatar}-doctor_list`\r\n            }\r\n            if (res.data.content[i].nurseAvatar && res.data.content[i].nurseAvatar.indexOf('qnfiles') > 0) {\r\n              res.data.content[i].nurseAvatar = `${res.data.content[i].nurseAvatar}-doctor_list`\r\n            }\r\n            res.data.content[i].createdDate = res.data.content[i].createdDate.slice(0, res.data.content[i].createdDate.lastIndexOf(':'))\r\n          }\r\n          this.conversationList = this.conversationList.concat(res.data.content);\r\n          this.currentPage = page;\r\n          this.getting = false;\r\n        }).catch(err => {\r\n          this.notice = err.response.data.message;\r\n          setTimeout(()=>{\r\n            this.notice = ''\r\n          }, 2000)\r\n        })\r\n      },\r\n      jumpTo (route, id) {\r\n        this.$store.commit('changePageType', 'package-page');\r\n        this.$router.push(`/${route}/${id}`);\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n  @function vm($px) {\r\n    @return ($px / 750) * 100vw;\r\n  }\r\n  .page{\r\n    height: calc(100vh - 13.06vw);\r\n  }\r\n\r\n  .contain{\r\n    min-height: 100vh;\r\n    background-color: #ffffff;\r\n  }\r\n  li{\r\n    display: block;\r\n    box-sizing: border-box;\r\n    width: 100vw;\r\n    height: vm(160);\r\n    border-bottom: #e2e2e2 vm(1) solid;\r\n    padding:  vm(30);\r\n    position: relative;\r\n  }\r\n  li::after{\r\n    content: '';\r\n    display: block;\r\n    clear: both;\r\n  }\r\n  li>img{\r\n    width: 10.66vw;\r\n    height: 10.66vw;\r\n    margin-right: 2.66vw;\r\n    border-radius: 50%;\r\n  }\r\n  li>div.left{\r\n    width: 78vw;\r\n    height:  vm(140);\r\n  }\r\n  li>div.left>div::after{\r\n    content: '';\r\n    display: block;\r\n    clear: both;\r\n  }\r\n  li>div.left>div.doctor{\r\n    line-height:  vm(32);\r\n    margin-top:  vm(10);\r\n  }\r\n  li>div.left>div.doctor>span:first-child{\r\n    font-size:  vm(32);\r\n    color: #333333;\r\n  }\r\n  li>div.left>div.doctor>span:nth-child(2){\r\n    font-size:  vm(26);\r\n    color: #666666;\r\n    margin-left:  vm(20);\r\n  }\r\n  li>div.left>div.doctor>span:last-child{\r\n    font-size:  vm(26);\r\n    color: #999999;\r\n  }\r\n  li>div.left>div.patient{\r\n    font-size:  vm(26);\r\n    color: #999999;\r\n    margin:  vm(15) 0 vm(20);\r\n  }\r\n  li>div.left>div.patient>.tag{\r\n    display: block;\r\n    width: vm(20);\r\n    height: vm(20);\r\n    border-radius: 50%;\r\n    background-color: #FF624D;\r\n  }\r\n  li>div.left>div.conver{\r\n    width: vm(496);\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    font-size: vm(28);\r\n    color: #666666;\r\n  }\r\n  li>div.left>img{\r\n    position: absolute;\r\n    bottom:  vm(10);\r\n    right:  vm(50);\r\n    width:  vm(120);\r\n    height:  vm(120);\r\n  }\r\n\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/consultation.component.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"page\",on:{\"scroll\":_vm.getMore}},[(_vm.conversationList.length === 0)?_c('div',{staticClass:\"emp\"},[_c('img',{attrs:{\"src\":\"static/images/empty-message.png\"}}),_vm._v(\" \"),_c('span',[_vm._v(\"你还没有咨询消息\")])]):_vm._e(),_vm._v(\" \"),(_vm.conversationList.length > 0)?_c('ul',{ref:\"listBox\",staticClass:\"contain\"},_vm._l((_vm.conversationList),function(item){return _c('li',{on:{\"click\":function($event){_vm.jumpTo('chat', item.orderHeaderId)}}},[_c('img',{staticClass:\"left\",attrs:{\"src\":item.doctorAvatar || item.nurseAvatar || \"static/images/defualt-header.png\"}}),_vm._v(\" \"),_c('div',{staticClass:\"left\"},[_c('div',{staticClass:\"doctor\"},[_c('span',{staticClass:\"left\"},[_vm._v(_vm._s(item.doctorName || item.nurseName))]),_c('span',{staticClass:\"left\"},[_vm._v(_vm._s(item.departmentText))]),_c('span',{staticClass:\"right\"},[_vm._v(_vm._s(item.createdDate))])]),_vm._v(\" \"),_c('div',{staticClass:\"patient\"},[_c('span',{staticClass:\"left\"},[_vm._v(\"就诊人 / \"+_vm._s(item.patientName))]),(item.newMessage)?_c('span',{staticClass:\"tag right\"}):_vm._e()]),_vm._v(\" \"),(item.statusCode === \"DOCTOR_COMPLETED\" || item.statusCode === \"AUTO_COMPLETED\")?_c('img',{attrs:{\"src\":\"static/images/end.png\"}}):_vm._e()])])})):_vm._e(),_vm._v(\" \"),(_vm.notice)?_c('notice',{attrs:{\"message\":_vm.notice}}):_vm._e()],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-5de267fa\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./src/components/consultation.component.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-5de267fa\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=0!./consultation.component.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./consultation.component.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./consultation.component.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-5de267fa\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./consultation.component.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-5de267fa\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/consultation.component.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}